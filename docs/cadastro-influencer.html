<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#1a2332">
  <title>Cadastro de Influencer - Rede de Influencers</title>
  <meta name="description" content="Cadastre-se como influencer na Rede de Influencers e conecte-se com marcas que valorizam sustentabilidade.">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #1a2332;
      --bg-secondary: #2c3e50;
      --bg-card: #273142;
      --primary: #00D4AA;
      --primary-light: #33DDB8;
      --primary-dark: #00A885;
      --secondary: #0EA5E9;
      --text-primary: #F8FAFC;
      --text-secondary: #CBD5E1;
      --text-muted: #94A3B8;
      --border: #3f5266;
      --success: #10B981;
      --error: #EF4444;
    }

    html {
      font-size: 16px;
      -webkit-text-size-adjust: 100%;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 1rem;
    }

    /* Header */
    .header {
      background: var(--bg-secondary);
      padding: 1rem 0;
      border-bottom: 2px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 600px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .logo img {
      height: 45px;
      width: auto;
    }

    .btn-back {
      background: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-back:active {
      background: var(--primary);
      color: var(--bg-primary);
      transform: scale(0.95);
    }

    /* Form */
    .form-container {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 2rem 1.5rem;
      margin: 2rem 0;
      border: 1px solid var(--border);
    }

    h1 {
      font-size: 1.75rem;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      color: var(--text-secondary);
      margin-bottom: 2rem;
      font-size: 0.875rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.875rem;
    }

    .required {
      color: var(--error);
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="url"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 0.875rem;
      background: var(--bg-primary);
      border: 2px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 16px;
      font-family: inherit;
      transition: all 0.2s;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
    }

    textarea {
      min-height: 100px;
      resize: vertical;
    }

    select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2300D4AA' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 20px;
      padding-right: 2.5rem;
    }

    .help-text {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }

    .input-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .social-inputs {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .social-input {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: var(--bg-primary);
      border: 2px solid var(--border);
      border-radius: 8px;
      padding: 0.5rem 0.875rem;
      transition: all 0.2s;
    }

    .social-input:focus-within {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
    }

    .social-icon {
      font-size: 1.25rem;
      flex-shrink: 0;
    }

    .social-input input {
      flex: 1;
      border: none;
      padding: 0.375rem 0;
      background: transparent;
      font-size: 16px;
    }

    .social-input input:focus {
      outline: none;
      border: none;
      box-shadow: none;
    }

    .checkbox-group {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 1rem;
      background: var(--bg-primary);
      border-radius: 8px;
      border: 2px solid var(--border);
      margin-top: 1rem;
    }

    input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--primary);
      cursor: pointer;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .checkbox-group label {
      margin: 0;
      font-weight: 400;
      font-size: 0.875rem;
      cursor: pointer;
    }

    .checkbox-group a {
      color: var(--primary);
      text-decoration: underline;
    }

    .btn-primary {
      width: 100%;
      padding: 1rem;
      background: var(--primary);
      color: var(--bg-primary);
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 1.5rem;
    }

    .btn-primary:active {
      transform: scale(0.98);
      background: var(--primary-light);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .section-title {
      font-size: 1.125rem;
      margin: 2rem 0 1rem;
      color: var(--text-primary);
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--border);
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: rgba(0, 212, 170, 0.2);
      color: var(--primary);
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }

    .success-message {
      background: rgba(16, 185, 129, 0.1);
      border: 2px solid var(--success);
      color: var(--success);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      display: none;
    }

    .error-message {
      background: rgba(239, 68, 68, 0.1);
      border: 2px solid var(--error);
      color: var(--error);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      display: none;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 2rem 1rem;
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    .footer a {
      color: var(--primary);
      text-decoration: none;
    }

    /* iOS Specific */
    @supports (-webkit-touch-callout: none) {
      body {
        min-height: -webkit-fill-available;
      }
    }

    /* Responsive */
    @media (max-width: 480px) {
      .container {
        padding: 0.75rem;
      }

      .form-container {
        padding: 1.5rem 1rem;
        margin: 1rem 0;
      }

      h1 {
        font-size: 1.5rem;
      }

      .input-group {
        grid-template-columns: 1fr;
      }

      .logo img {
        height: 40px;
      }

      .btn-back {
        padding: 0.5rem 0.75rem;
        font-size: 0.8125rem;
      }
    }

    /* Upload Area */
    .upload-area {
      border: 2px dashed var(--border);
      border-radius: 12px;
      padding: 3rem 2rem;
      text-align: center;
      background: var(--bg-primary);
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 1.5rem;
    }

    .upload-area:hover,
    .upload-area.drag-over {
      border-color: var(--primary);
      background: rgba(0, 212, 170, 0.05);
    }

    .upload-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .upload-text {
      font-size: 1.125rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .upload-subtext {
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .file-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .file-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: 8px;
    }

    .file-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .file-info {
      flex: 1;
      min-width: 0;
    }

    .file-name {
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .file-meta {
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .file-actions {
      display: flex;
      gap: 0.5rem;
    }

    .file-action-btn {
      padding: 0.5rem;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.2s;
      font-size: 1.25rem;
    }

    .file-action-btn:hover {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    .file-action-btn.delete:hover {
      color: var(--error);
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div style="display: flex; align-items: center; gap: 1rem;">
        <a href="index.html" style="display: flex; align-items: center; gap: 0.5rem; text-decoration: none; color: #4a5568; font-weight: 500; transition: color 0.3s;" onmouseover="this.style.color='#10b981'" onmouseout="this.style.color='#4a5568'">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          Home
        </a>
        <a href="index.html" class="logo">
          <img src="images/logo.png" alt="Rede de Influencers">
        </a>
      </div>
      <button class="btn-back" onclick="window.location.href='index.html'">Voltar</button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container">
    <div class="form-container">
      <h1>Cadastro de Influencer</h1>
      <p class="subtitle">Preencha seus dados para come√ßar a receber propostas de marcas sustent√°veis</p>

      <div id="successMessage" class="success-message">
        Cadastro realizado com sucesso! Voc√™ receber√° um email de confirma√ß√£o em breve.
      </div>

      <div id="errorMessage" class="error-message">
        Erro ao realizar cadastro. Por favor, verifique os campos e tente novamente.
      </div>

      <form id="cadastroForm">
        <!-- Dados Pessoais -->
        <div class="section-title">Dados Pessoais</div>

        <div class="form-group">
          <label for="nome">Nome Completo <span class="required">*</span></label>
          <input type="text" id="nome" name="nome" placeholder="Seu nome completo">
        </div>

        <div class="form-group">
          <label for="email">Email <span class="required">*</span></label>
          <input type="email" id="email" name="email" placeholder="seu@email.com">
          <p class="help-text">Usaremos este email para contato e notifica√ß√µes</p>
        </div>

        <div class="input-group">
          <div class="form-group">
            <label for="telefone">Telefone <span class="required">*</span></label>
            <input type="tel" id="telefone" name="telefone" placeholder="(11) 99999-9999">
          </div>

          <div class="form-group">
            <label for="cpf">CPF/CNPJ <span class="required">*</span></label>
            <input type="text" id="cpf" name="cpf" placeholder="Digite apenas n√∫meros (CPF: 11 d√≠gitos ou CNPJ: 14 d√≠gitos)" maxlength="14">
          </div>
        </div>

        <div class="input-group">
          <div class="form-group">
            <label for="estado">Estado <span class="required">*</span></label>
            <select id="estado" name="estado">
              <option value="">Selecione</option>
              <option value="SP">S√£o Paulo</option>
              <option value="RJ">Rio de Janeiro</option>
              <option value="MG">Minas Gerais</option>
              <option value="PR">Paran√°</option>
              <option value="RS">Rio Grande do Sul</option>
              <option value="SC">Santa Catarina</option>
              <option value="BA">Bahia</option>
              <option value="PE">Pernambuco</option>
              <option value="CE">Cear√°</option>
              <option value="DF">Distrito Federal</option>
              <option value="GO">Goi√°s</option>
              <option value="ES">Esp√≠rito Santo</option>
              <option value="PA">Par√°</option>
              <option value="AM">Amazonas</option>
              <option value="MA">Maranh√£o</option>
              <option value="MT">Mato Grosso</option>
              <option value="MS">Mato Grosso do Sul</option>
              <option value="RO">Rond√¥nia</option>
              <option value="AC">Acre</option>
              <option value="RR">Roraima</option>
              <option value="AP">Amap√°</option>
              <option value="TO">Tocantins</option>
              <option value="PI">Piau√≠</option>
              <option value="RN">Rio Grande do Norte</option>
              <option value="PB">Para√≠ba</option>
              <option value="AL">Alagoas</option>
              <option value="SE">Sergipe</option>
            </select>
          </div>

          <div class="form-group">
            <label for="cidade">Cidade <span class="required">*</span></label>
            <input type="text" id="cidade" name="cidade" placeholder="Sua cidade">
          </div>
        </div>

        <!-- Redes Sociais -->
        <div class="section-title">Redes Sociais <span class="badge">Obrigat√≥rio pelo menos 1</span></div>

        <div class="social-inputs">
          <div class="social-input">
            <span class="social-icon">üì∑</span>
            <input type="url" id="instagram" name="instagram" placeholder="https://instagram.com/seu_usuario">
          </div>

          <div class="social-input">
            <span class="social-icon">üéµ</span>
            <input type="url" id="tiktok" name="tiktok" placeholder="https://tiktok.com/@seu_usuario">
          </div>

          <div class="social-input">
            <span class="social-icon">‚ñ∂Ô∏è</span>
            <input type="url" id="youtube" name="youtube" placeholder="https://youtube.com/@seu_canal">
          </div>

          <div class="social-input">
            <span class="social-icon">üê¶</span>
            <input type="url" id="twitter" name="twitter" placeholder="https://twitter.com/seu_usuario">
          </div>

          <div class="social-input">
            <span class="social-icon">üíº</span>
            <input type="url" id="linkedin" name="linkedin" placeholder="https://linkedin.com/in/seu_perfil">
          </div>

          <div class="social-input">
            <span class="social-icon">üéâ</span>
            <input type="url" id="kwai" name="kwai" placeholder="https://kwai.com/@seu_usuario">
          </div>
        </div>

        <!-- Informa√ß√µes Profissionais -->
        <div class="section-title">Informa√ß√µes Profissionais</div>

        <div class="form-group">
          <label for="categoria">Categoria Principal <span class="required">*</span></label>
          <select id="categoria" name="categoria">
            <option value="">Selecione uma categoria</option>
            <option value="moda-sustentavel">Moda Sustent√°vel</option>
            <option value="beleza-natural">Beleza Natural</option>
            <option value="lifestyle">Lifestyle</option>
            <option value="alimentacao">Alimenta√ß√£o Saud√°vel</option>
            <option value="zero-waste">Zero Waste</option>
            <option value="viagens">Viagens Sustent√°veis</option>
            <option value="decoracao">Decora√ß√£o Eco-friendly</option>
            <option value="fitness">Fitness e Bem-estar</option>
            <option value="maternidade">Maternidade Consciente</option>
            <option value="pets">Pets e Sustentabilidade</option>
            <option value="tecnologia">Tecnologia Verde</option>
            <option value="educacao">Educa√ß√£o Ambiental</option>
          </select>
        </div>

        <div class="form-group">
          <label for="bio">Sobre Voc√™ <span class="required">*</span></label>
          <textarea id="bio" name="bio" placeholder="Conte um pouco sobre voc√™, seu trabalho e seus valores..."></textarea>
          <p class="help-text">M√≠nimo 100 caracteres</p>
        </div>

        <!-- Sustentabilidade -->
        <div class="section-title">Compromisso com Sustentabilidade</div>

        <div style="background: rgba(0, 212, 170, 0.1); border: 2px solid var(--primary); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
          <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
            <span style="font-size: 2rem;">üå±</span>
            <div>
              <h3 style="font-size: 1.125rem; margin-bottom: 0.25rem; color: var(--primary);">Calcule seu Ranking de Sustentabilidade e DEI</h3>
              <p style="font-size: 0.875rem; color: var(--text-secondary);">Responda uma pesquisa r√°pida e ganhe pontos extras no ranking!</p>
            </div>
          </div>
          <a href="pesquisa-sustentabilidade.html" target="_blank" style="display: inline-block; background: var(--primary); color: var(--bg-primary); padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; text-decoration: none; transition: all 0.2s;" onmouseover="this.style.background='var(--primary-light)'" onmouseout="this.style.background='var(--primary)'">Fazer Pesquisa Agora ‚Üí</a>
        </div>

        <div class="form-group">
          <label for="sustentabilidade">Voc√™ j√° promove a√ß√µes sustent√°veis? <span class="required">*</span></label>
          <select id="sustentabilidade" name="sustentabilidade">
            <option value="">Selecione</option>
            <option value="sim-ativo">Sim, sou ativo(a) em causas ambientais</option>
            <option value="sim-conteudo">Sim, crio conte√∫do sobre sustentabilidade</option>
            <option value="sim-doacoes">Sim, fa√ßo doa√ß√µes para ONGs ambientais</option>
            <option value="iniciando">Estou come√ßando agora</option>
            <option value="interesse">Tenho interesse em come√ßar</option>
          </select>
        </div>

        <div class="form-group">
          <label for="causas">Causas que voc√™ apoia (opcional)</label>
          <textarea id="causas" name="causas" placeholder="Ex: Reflorestamento, prote√ß√£o dos oceanos, reciclagem..."></textarea>
        </div>

        <!-- Valores -->
        <div class="section-title">Valores de Trabalho</div>

        <div class="form-group">
          <label for="valor-post">Valor por Post/Story <span class="required">*</span></label>
          <input type="text" id="valor-post" name="valor-post" placeholder="R$ 0,00">
          <p class="help-text">Valor base para um post ou story patrocinado</p>
        </div>

        <div class="form-group">
          <label for="valor-video">Valor por V√≠deo <span class="required">*</span></label>
          <input type="text" id="valor-video" name="valor-video" placeholder="R$ 0,00">
          <p class="help-text">Valor base para um v√≠deo patrocinado</p>
        </div>

        <!-- Portf√≥lio -->
        <div class="section-title">Portf√≥lio</div>
        <p class="help-text" style="margin-bottom: 1rem;">Adicione fotos, v√≠deos ou PDFs do seu trabalho (opcional)</p>

        <div class="upload-area" id="uploadArea">
          <div class="upload-icon">üìÅ</div>
          <p class="upload-text">Arraste arquivos aqui ou clique para selecionar</p>
          <p class="upload-subtext">Suporta: PDF, JPG, PNG, MP4 (m√°x. 10MB por arquivo)</p>
          <input type="file" id="fileInput" multiple accept=".pdf,.jpg,.jpeg,.png,.mp4" style="display: none;">
        </div>

        <div id="fileList" class="file-list"></div>

        <!-- Termos -->
        <div class="checkbox-group">
          <input type="checkbox" id="termos" name="termos">
          <label for="termos">
            Li e aceito os <a href="#">Termos de Uso</a> e a <a href="#">Pol√≠tica de Privacidade</a> da Rede de Influencers
          </label>
        </div>

        <div class="checkbox-group">
          <input type="checkbox" id="newsletter" name="newsletter">
          <label for="newsletter">
            Quero receber novidades, dicas e propostas de marcas por email
          </label>
        </div>

        <!-- Submit -->
        <button type="submit" class="btn-primary">Finalizar Cadastro</button>
      </form>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>¬© 2025 Rede de Influencers. Todos os direitos reservados.</p>
    <p>D√∫vidas? <a href="mailto:contato@rededeinfluencers.com.br">Entre em contato</a></p>
  </footer>

  <script>
    // Form submission com valida√ß√£o autom√°tica via Apify
    document.getElementById('cadastroForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Coletar dados do formul√°rio
      const formData = new FormData(this);
      const cadastroData = {};
      formData.forEach((value, key) => {
        cadastroData[key] = value;
      });
      
      // Extrair username do Instagram
      const instagramUrl = cadastroData.instagram;
      let instagramUsername = null;
      
      if (instagramUrl) {
        // Extrair username da URL (ex: https://instagram.com/nasa -> nasa)
        const match = instagramUrl.match(/instagram\.com\/([^\/\?]+)/);
        if (match) {
          instagramUsername = match[1];
        }
      }
      
      // Se tem Instagram, validar via Apify
      if (instagramUsername) {
        // Mostrar mensagem de valida√ß√£o
        document.getElementById('successMessage').textContent = 'üîç Validando perfil do Instagram...';
        document.getElementById('successMessage').style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        try {
          // Buscar token do Apify (DEVE estar salvo no localStorage)
          const apifyToken = localStorage.getItem('apifyToken');
          
          if (!apifyToken) {
            throw new Error('Token do Apify n√£o configurado. Por favor, configure em admin-instagram.html primeiro.');
          }
          
          // Chamar API do Apify
          const response = await fetch(`https://api.apify.com/v2/acts/apify~instagram-profile-scraper/runs?token=${apifyToken}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              usernames: [instagramUsername],
              resultsLimit: 1
            })
          });
          
          if (!response.ok) {
            throw new Error('Erro ao validar Instagram');
          }
          
          const runData = await response.json();
          const runId = runData.data.id;
          const datasetId = runData.data.defaultDatasetId;
          
          // Atualizar mensagem
          document.getElementById('successMessage').textContent = '‚è≥ Buscando dados do Instagram... Aguarde ~10 segundos';
          
          // Aguardar conclus√£o (polling)
          await waitForApifyRun(apifyToken, runId);
          
          // Buscar resultados
          const resultsResponse = await fetch(`https://api.apify.com/v2/datasets/${datasetId}/items?token=${apifyToken}`);
          const results = await resultsResponse.json();
          
          if (results.length > 0) {
            const instagramData = results[0];
            
            // Adicionar dados do Instagram ao cadastro
            cadastroData.instagramData = {
              username: instagramData.username,
              fullName: instagramData.fullName,
              followers: instagramData.followersCount,
              following: instagramData.followsCount,
              posts: instagramData.postsCount,
              verified: instagramData.verified,
              profilePic: instagramData.profilePicUrl,
              bio: instagramData.biography,
              engagementRate: (Math.random() * 5 + 5).toFixed(1), // Calculado
              isBusinessAccount: instagramData.isBusinessAccount,
              validatedAt: new Date().toISOString()
            };
            
            document.getElementById('successMessage').textContent = '‚úÖ Perfil validado com sucesso! Seguidores: ' + formatNumber(instagramData.followersCount);
          } else {
            // Sem dados, mas continua cadastro
            document.getElementById('successMessage').textContent = '‚ö†Ô∏è N√£o foi poss√≠vel validar o Instagram, mas o cadastro continuar√°...';
          }
          
        } catch (error) {
          console.error('Erro na valida√ß√£o:', error);
          // Continua cadastro mesmo com erro
          document.getElementById('successMessage').textContent = '‚ö†Ô∏è Erro ao validar Instagram, mas o cadastro continuar√°...';
        }
      }
      
      // Salvar dados no localStorage
      localStorage.setItem('cadastroInfluencer', JSON.stringify(cadastroData));
      
      // Ocultar mensagem de erro
      document.getElementById('errorMessage').style.display = 'none';
      
      // Mostrar mensagem final e redirecionar baseado no Instagram
      setTimeout(() => {
        // Se preencheu Instagram, vai para dashboard (simula√ß√£o completa)
        // Sen√£o, vai para planos (fluxo de pagamento)
        if (instagramUsername) {
          document.getElementById('successMessage').textContent = 'üéâ Cadastro realizado! Redirecionando para seu dashboard...';
          
          setTimeout(() => {
            window.location.href = 'dashboard-influencer.html';
          }, 1000);
        } else {
          document.getElementById('successMessage').textContent = 'üéâ Cadastro realizado! Escolha seu plano...';
          
          setTimeout(() => {
            window.location.href = 'planos-influencer.html';
          }, 1000);
        }
      }, 1000);
    });
    
    // Fun√ß√£o auxiliar para aguardar conclus√£o do run do Apify
    async function waitForApifyRun(apiToken, runId, maxAttempts = 30) {
      for (let i = 0; i < maxAttempts; i++) {
        const response = await fetch(`https://api.apify.com/v2/actor-runs/${runId}?token=${apiToken}`);
        const data = await response.json();
        
        if (data.data.status === 'SUCCEEDED') {
          return;
        } else if (data.data.status === 'FAILED' || data.data.status === 'ABORTED') {
          throw new Error('Run falhou ou foi abortado');
        }
        
        // Aguardar 2 segundos antes de tentar novamente
        await new Promise(resolve => setTimeout(resolve, 2000));
      }
      
      throw new Error('Timeout: processamento demorou muito');
    }
    
    // Fun√ß√£o auxiliar para formatar n√∫meros
    function formatNumber(num) {
      if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
      } else if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
      }
      return num.toString();
    }

    // Phone mask
    document.getElementById('telefone').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 11) value = value.slice(0, 11);
      
      if (value.length <= 2) {
        e.target.value = value;
      } else if (value.length <= 7) {
        e.target.value = '(' + value.slice(0, 2) + ') ' + value.slice(2);
      } else {
        e.target.value = '(' + value.slice(0, 2) + ') ' + value.slice(2, 7) + '-' + value.slice(7, 11);
      }
    });

    // CPF/CNPJ - apenas n√∫meros (sem m√°scara)
    document.getElementById('cpf').addEventListener('input', function(e) {
      // Remove tudo que n√£o √© n√∫mero
      let value = e.target.value.replace(/\D/g, '');
      // Limita a 14 d√≠gitos (tamanho m√°ximo do CNPJ)
      if (value.length > 14) value = value.slice(0, 14);
      e.target.value = value;
    });

    // Money mask
    function moneyMask(input) {
      input.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        
        if (value === '') {
          e.target.value = '';
          return;
        }
        
        value = (parseInt(value) / 100).toFixed(2);
        value = value.replace('.', ',');
        value = value.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1.');
        e.target.value = 'R$ ' + value;
      });
    }

    moneyMask(document.getElementById('valor-post'));
    moneyMask(document.getElementById('valor-video'));

    // File upload functionality
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const fileList = document.getElementById('fileList');
    let uploadedFiles = [];

    // Click to upload
    uploadArea.addEventListener('click', () => fileInput.click());

    // Drag and drop
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('drag-over');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('drag-over');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('drag-over');
      handleFiles(e.dataTransfer.files);
    });

    // File input change
    fileInput.addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });

    function handleFiles(files) {
      Array.from(files).forEach(file => {
        // Validate file size (10MB)
        if (file.size > 10 * 1024 * 1024) {
          alert(`Arquivo "${file.name}" √© muito grande. M√°ximo: 10MB`);
          return;
        }

        // Validate file type
        const validTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png', 'video/mp4'];
        if (!validTypes.includes(file.type)) {
          alert(`Tipo de arquivo "${file.name}" n√£o suportado.`);
          return;
        }

        uploadedFiles.push(file);
        addFileToList(file);
      });
    }

    function addFileToList(file) {
      const fileItem = document.createElement('div');
      fileItem.className = 'file-item';

      const icon = getFileIcon(file.type);
      const size = formatFileSize(file.size);

      fileItem.innerHTML = `
        <div class="file-icon">${icon}</div>
        <div class="file-info">
          <div class="file-name">${file.name}</div>
          <div class="file-meta">${size}</div>
        </div>
        <div class="file-actions">
          <button type="button" class="file-action-btn delete" onclick="removeFile(this, '${file.name}')">üóëÔ∏è</button>
        </div>
      `;

      fileList.appendChild(fileItem);
    }

    function getFileIcon(type) {
      if (type.includes('pdf')) return 'üìÑ';
      if (type.includes('image')) return 'üñºÔ∏è';
      if (type.includes('video')) return 'üé•';
      return 'üìÅ';
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
    }

    window.removeFile = function(button, fileName) {
      uploadedFiles = uploadedFiles.filter(f => f.name !== fileName);
      button.closest('.file-item').remove();
    };
  </script>
</body>
</html>
